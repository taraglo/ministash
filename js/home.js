const{ipcRenderer:ipcRenderer}=require("electron"),Plyr=require("plyr"),currentYear=(new Date).getFullYear(),year=2023;document.getElementById("copyright").innerHTML=`Copyright © ${2023===currentYear?2023:currentYear} <a href='https://github.com/taraglo' target='_blank'>taraglo</a>. All rights reserved.`;const container=document.getElementsByClassName("container")[0],modal=document.getElementsByClassName("modal")[0],modalContent=document.getElementsByClassName("modal-content")[0],modalVideo=document.getElementById("modal-video"),modalTitle=document.getElementById("modal-title"),modalModel=document.getElementById("modal-model"),modalClose=document.getElementById("modal-close"),modalInfo=document.getElementById("modal-info");let showMaxVideoAlert=!0;const modalAlert=document.getElementsByClassName("modal-alert")[0],modalAlertCheckbox=document.getElementById("modal-alert-checkbox"),modalAlertClose=document.getElementById("modal-alert-close"),modalAlertYes=document.getElementById("modal-alert-yes"),modalAlertNo=document.getElementById("modal-alert-no"),totalCount=document.getElementById("total-count"),videoSection=document.getElementById("videos"),selectDirectory=document.getElementById("dirs");let folder="",videos=[],videoCount=0,totalVideosPlaying=0;const videoPerPage=12;let lastVideoIndex=0,multiplayState=!1;const btn_multiplay=document.getElementById("multiplay"),btn_models=document.getElementById("models"),btn_random=document.getElementById("random"),btn_load_more=document.getElementById("load-more"),btn_scroll_up=document.getElementById("scroll-up");btn_multiplay.addEventListener("click",(function(){let e=document.getElementsByClassName("video-content");if(multiplayState){for(let t=0;t<e.length;t++)e[t].style.width="calc((100% / 4) - 10px)",e[t].firstChild.style.height="auto",e[t].lastChild.style.display="block",e[t].style.marginBottom="0px";container.style.margin="35px",multiplayState=!1,btn_multiplay.innerHTML="Goon Mode",document.fullscreenElement&&document.exitFullscreen()}else{let t=0;for(let l=0;l<e.length;l++)e[l].style.width="calc((100% / 2) - 10px)",e[l].firstChild.style.height="100%",e[l].lastChild.style.display="none",t++,t>=3&&(e[l].style.marginBottom="100px"),4==t&&(t=0);container.style.margin="35px 5px",multiplayState=!0,btn_multiplay.innerHTML="Gallery Mode",document.fullscreenElement||document.documentElement.requestFullscreen()}})),btn_models.addEventListener("click",(function(){window.location.href="./models.html"})),btn_random.addEventListener("click",(function(){let e=Math.floor(Math.random()*videoCount),t=videos[e],l=document.getElementsByClassName("video-content");for(let e=0;e<l.length;e++){l[e].firstChild.getElementsByClassName("plyr__video-wrapper")[0].firstChild.pause()}let o=document.createElement("video");o.id="playerr"+e,o.controls=!0,o.autoplay=!0,o.style.width="100%";let n=document.createElement("source");n.src=t.path,n.type="video/mp4",o.append(n),modalVideo.innerHTML="",modalVideo.append(o),modalTitle.innerHTML="Title: "+capitalizeFirstLetter(getTitleName(t.name)),modalModel.innerHTML="Pornstar: "+toTitleCase(getModelName(t.name));new Plyr("#playerr"+e,{controls:["play","progress","current-time","mute","fullscreen"],settings:[""]});modal.style.display="block",disableScrolling()})),modalClose.addEventListener("click",(function(){modal.style.display="none",modalVideo.innerHTML="",enableScrolling()})),document.addEventListener("keydown",(function(e){if("block"==modal.style.display)if(82==e.keyCode){let e=Math.floor(Math.random()*videoCount),t=videos[e],l=document.createElement("video");l.id="playerr"+e,l.controls=!0,l.autoplay=!0,l.style.width="100%";let o=document.createElement("source");o.src=t.path,o.type="video/mp4",l.append(o),modalVideo.innerHTML="",modalVideo.append(l),modalTitle.innerHTML="Title: "+capitalizeFirstLetter(getTitleName(t.name)),modalModel.innerHTML="Pornstar: "+toTitleCase(getModelName(t.name));new Plyr("#playerr"+e,{controls:["play","progress","current-time","mute","fullscreen"],settings:[""]});modal.style.display="block"}else 72==e.keyCode&&("none"==modalInfo.style.display?modalInfo.style.display="block":modalInfo.style.display="none");if(70==e.keyCode&&goFullScreen(),27==e.keyCode&&exitFullScreen(),80==e.keyCode){let e=document.getElementsByClassName("video-content");for(let t=0;t<e.length;t++){e[t].firstChild.getElementsByClassName("plyr__video-wrapper")[0].firstChild.pause()}}})),document.addEventListener("DOMContentLoaded",(function(){null!==localStorage.getItem("folder")&&""!==localStorage.getItem("folder")||""!==folder?(folder=localStorage.getItem("folder"),ipcRenderer.send("get-files",folder)):ipcRenderer.send("open-folder"),showMaxVideoAlert=null===localStorage.getItem("showMaxVideoAlert")||"true"===localStorage.getItem("showMaxVideoAlert")})),ipcRenderer.on("selected-directory",((e,t)=>{folder=t,localStorage.setItem("folder",t),ipcRenderer.send("get-files",t),window.location.reload()})),ipcRenderer.on("clear-localstorage",(e=>{localStorage.setItem("folder","")})),ipcRenderer.on("get-files-response",((e,t)=>{t.forEach((e=>{videos.push(e)})),videoCount=videos.length,totalCount.innerHTML="Total "+videoCount+" videos • Displaying 12 videos",videos.sort((function(){return.5-Math.random()}));for(let e=0;e<12;e++){let t=document.createElement("div");t.className="video-content";let l=document.createElement("div");l.className="video-info";let o=document.createElement("p");o.innerHTML=toTitleCase(getTitleName(videos[e].name));let n=document.createElement("video");n.id="player"+e,n.playsInline=!0,n.controls=!0,n.preload=!0,n.muted=!0;let d=document.createElement("source");d.src=videos[e].path,d.type="video/mp4",n.addEventListener("play",(function(){totalVideosPlaying++,totalVideosPlaying>4&&showMaxVideoAlert&&(modalAlert.style.display="block",disableScrolling())})),n.addEventListener("pause",(function(){totalVideosPlaying--})),n.append(d),l.append(o),t.append(n),t.append(l),videoSection.append(t);new Plyr("#player"+e,{controls:["play","progress","current-time","mute","fullscreen"],settings:[""]}).muted=!0}lastVideoIndex=12})),modalAlertClose.addEventListener("click",(function(){modalAlert.style.display="none",enableScrolling()})),modalAlertYes.addEventListener("click",(function(){modalAlert.style.display="none",enableScrolling(),showMaxVideoAlert=!1})),modalAlertNo.addEventListener("click",(function(){if(modalAlert.style.display="none",enableScrolling(),showMaxVideoAlert=null===localStorage.getItem("showMaxVideoAlert")||"true"===localStorage.getItem("showMaxVideoAlert"),totalVideosPlaying>4){let e=document.getElementsByClassName("video-content");for(let t=0;t<e.length;t++){e[t].firstChild.getElementsByClassName("plyr__video-wrapper")[0].firstChild.pause()}}})),modalAlertCheckbox.addEventListener("click",(function(){localStorage.setItem("showMaxVideoAlert",!modalAlertCheckbox.checked)})),btn_load_more.addEventListener("click",(function(){if(!(lastVideoIndex>=videoCount)){if(lastVideoIndex+12>videoCount){for(let e=lastVideoIndex;e<videoCount;e++){let t=document.createElement("div");t.className="video-content";let l=document.createElement("div");l.className="video-info";let o=document.createElement("p");o.innerHTML=toTitleCase(getTitleName(videos[e].name));let n=document.createElement("video");n.id="player"+e,n.playsInline=!0,n.controls=!0,n.preload=!0,n.muted=!0;let d=document.createElement("source");d.src=videos[e].path,d.type="video/mp4",n.addEventListener("play",(function(){totalVideosPlaying++,totalVideosPlaying>4&&showMaxVideoAlert&&(modalAlert.style.display="block",disableScrolling())})),n.addEventListener("pause",(function(){totalVideosPlaying--})),n.append(d),l.append(o),t.append(n),t.append(l),videoSection.append(t);new Plyr("#player"+e,{controls:["play","progress","current-time","mute","fullscreen"],settings:[""]}).muted=!0}lastVideoIndex=videoCount}else{for(let e=lastVideoIndex;e<lastVideoIndex+12;e++){let t=document.createElement("div");t.className="video-content";let l=document.createElement("div");l.className="video-info";let o=document.createElement("p");o.innerHTML=toTitleCase(getTitleName(videos[e].name));let n=document.createElement("video");n.id="player"+e,n.playsInline=!0,n.controls=!0,n.preload=!0,n.muted=!0;let d=document.createElement("source");d.src=videos[e].path,d.type="video/mp4",n.addEventListener("play",(function(){totalVideosPlaying++,totalVideosPlaying>4&&showMaxVideoAlert&&(modalAlert.style.display="block",disableScrolling())})),n.addEventListener("pause",(function(){totalVideosPlaying--})),n.append(d),l.append(o),t.append(n),t.append(l),videoSection.append(t);new Plyr("#player"+e,{controls:["play","progress","current-time","mute","fullscreen"],settings:[""]}).muted=!0}lastVideoIndex+=12}totalCount.innerHTML="Total "+videoCount+" videos • Displaying "+lastVideoIndex+" videos"}})),btn_scroll_up.addEventListener("click",(function(){window.scrollTo(0,0)}));