const{ipcRenderer:ipcRenderer}=require("electron"),Plyr=require("plyr"),fs=require("fs"),path=require("path"),currentYear=(new Date).getFullYear(),year=2023;document.getElementById("copyright").innerHTML=`Copyright Â© ${2023===currentYear?2023:currentYear} <a href='https://github.com/taraglo' target='_blank'>taraglo</a>. All rights reserved.`;const totalCount=document.getElementById("total-count"),container=document.getElementsByClassName("container")[0],modelSection=document.getElementById("stars"),videoSection=document.getElementById("videos"),btn_home=document.getElementById("home"),btn_random=document.getElementById("random"),btn_pornstars=document.getElementById("pornstars"),btn_multiplay=document.getElementById("multiplay");let folder=localStorage.getItem("folder"),models=[],modelCount=0,currentModelVideosCount=0,multiplayState=!1,totalVideosPlaying=0,showMaxVideoAlert=!0;const modalAlert=document.getElementsByClassName("modal-alert")[0],modalAlertCheckbox=document.getElementById("modal-alert-checkbox"),modalAlertClose=document.getElementById("modal-alert-close"),modalAlertYes=document.getElementById("modal-alert-yes"),modalAlertNo=document.getElementById("modal-alert-no");document.addEventListener("DOMContentLoaded",(function(){showMaxVideoAlert=null===localStorage.getItem("showMaxVideoAlert")||"true"===localStorage.getItem("showMaxVideoAlert")})),document.addEventListener("keydown",(function(e){if(70==e.keyCode&&goFullScreen(),27==e.keyCode&&exitFullScreen(),80==e.keyCode){let e=document.getElementsByClassName("video-content");for(let t=0;t<e.length;t++){e[t].firstChild.getElementsByClassName("plyr__video-wrapper")[0].firstChild.pause()}}})),ipcRenderer.send("get-files",folder),ipcRenderer.on("clear-localstorage",(e=>{localStorage.setItem("folder","")})),ipcRenderer.on("get-files-response",((e,t)=>{t.forEach((e=>{let l=getModels(e.name);for(let e=0;e<l.length;e++)if(-1==models.indexOf(l[e])){models.push(l[e]);const n=document.createElement("button");n.classList.add("model");const o=document.createElement("img"),a=l[e].replaceAll(" ","-")+".jpg";let d=path.join(__dirname,"assets","models",a);fs.existsSync(d)?(o.src=d,o.alt=l[e]):(o.src="./assets/models/placeholder.webp",o.alt="placeholder");const r=document.createElement("p");r.innerHTML=toTitleCase(l[e]),n.appendChild(o),n.appendChild(r),modelSection.appendChild(n),n.addEventListener("click",(function(){let n=[],o=0;t.forEach(((t,a)=>{if(t.name.includes(l[e].replaceAll(" ","-"))){n.push(t);let e=document.createElement("div");e.className="video-content";let l=document.createElement("div");l.className="video-info";let d=document.createElement("p");d.innerHTML=toTitleCase(getTitleName(t.name));let r=document.createElement("video");r.id="player"+a,r.playsInline=!0,r.controls=!0,r.preload=!0;let i=document.createElement("source");i.src=t.path,i.type="video/mp4",r.addEventListener("play",(function(){totalVideosPlaying++,totalVideosPlaying>4&&showMaxVideoAlert&&(modalAlert.style.display="block",disableScrolling())})),r.addEventListener("pause",(function(){totalVideosPlaying--})),r.append(i),l.append(d),e.append(r),e.append(l),videoSection.append(e),o++,new Plyr("#player"+a,{controls:["play","progress","current-time","mute","fullscreen"],settings:[""]}).muted=!0}})),currentModelVideosCount=o,totalCount.innerHTML="Total "+o+" videos of "+toTitleCase(l[e]),modelSection.style.display="none",videoSection.style.display="flex",videoSection.style.justifyContent="flex-start",videoSection.style.flexWrap="wrap",videoSection.style.alignItems="flex-start",videoSection.style.gap="10px",btn_pornstars.style.display="inline",btn_multiplay.style.display="inline"}))}})),modelCount=models.length,totalCount.innerHTML="Total "+modelCount+" pornstars"})),ipcRenderer.on("selected-directory",((e,t)=>{folder=t,localStorage.setItem("folder",t),ipcRenderer.send("get-files",t),window.location.reload()})),btn_home.addEventListener("click",(function(){window.location.href="./index.html"})),btn_pornstars.addEventListener("click",(function(){window.location.reload()})),btn_random.addEventListener("click",(function(){videoSection.innerHTML="";const e=document.getElementsByTagName("button");let t=e[Math.floor(Math.random()*e.length)];for(;"menu"===t.attributes["data-btn"];)t=e[Math.floor(Math.random()*e.length)];t.click(),multiplayState&&btn_multiplay.click()})),btn_multiplay.addEventListener("click",(function(){let e=document.getElementsByClassName("video-content");if(multiplayState){for(let t=0;t<e.length;t++)e[t].style.width="calc((100% / 4) - 10px)",e[t].firstChild.style.height="auto",e[t].lastChild.style.display="block",e[t].style.marginBottom="0px";container.style.margin="35px",multiplayState=!1,btn_multiplay.innerHTML="Goon Mode",document.fullscreenElement&&document.exitFullscreen()}else{let t=0;for(let l=0;l<e.length;l++)e[l].style.width=1==currentModelVideosCount?"calc((100% - 10px)":"calc((100% / 2) - 10px)",e[l].firstChild.style.height="100%",e[l].lastChild.style.display="none",t++,t>=3&&(e[l].style.marginBottom="100px"),4==t&&(t=0);container.style.margin="35px 5px",multiplayState=!0,btn_multiplay.innerHTML="Gallery Mode",document.fullscreenElement||document.documentElement.requestFullscreen()}})),modalAlertClose.addEventListener("click",(function(){modalAlert.style.display="none",enableScrolling()})),modalAlertYes.addEventListener("click",(function(){modalAlert.style.display="none",enableScrolling(),showMaxVideoAlert=!1})),modalAlertNo.addEventListener("click",(function(){if(modalAlert.style.display="none",enableScrolling(),showMaxVideoAlert=null===localStorage.getItem("showMaxVideoAlert")||"true"===localStorage.getItem("showMaxVideoAlert"),totalVideosPlaying>4){let e=document.getElementsByClassName("video-content");for(let t=0;t<e.length;t++){e[t].firstChild.getElementsByClassName("plyr__video-wrapper")[0].firstChild.pause()}}})),modalAlertCheckbox.addEventListener("click",(function(){localStorage.setItem("showMaxVideoAlert",!modalAlertCheckbox.checked)}));